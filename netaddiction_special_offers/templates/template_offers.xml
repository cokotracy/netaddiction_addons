<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="offer_template" name="Offerta | Multiplayer.com">
		<t t-call="website.layout">
			<div>
				<t t-set="current_url" t-value="request.httprequest.full_path"/>
				<t t-if="not 'page=' in current_url">
					<t t-if="offer.mobile_image">
						<img class="d-md-none col-12 container-fluid p-0" t-attf-src="data:image/png;base64,{{offer.mobile_image}}"/>
					</t>
					<t t-if="offer.desktop_image">
						<img class="d-none d-md-block col-12 container p-0" t-attf-src="data:image/png;base64,{{offer.desktop_image}}"/>
					</t>
				</t>
				<t t-if="offer.name">
					<div class="container nopadding" style="background-color: #f5f5f5;">
						<div class="row nopadding">
							<div class="col-sm nopadding text-center">
								<h1 class="d-inline py-3 d-block" t-esc="offer.name"></h1>
								<t t-if="offer.description">
									<p class="pb-3" t-esc="offer.description"></p>
								</t>
							</div>
						</div>
					</div>
				</t>
			</div>
			<br />
			<t t-call="netaddiction_special_offers.pagination_offer" />
			<div class="d-flex container">
				<t t-if="offer.active_frontend_filter">
					<div id="products_grid_before" class="d-none d-lg-block w-100 te_product_sticky_sidebar te_product_sidebar_scrollbar sticky-media mCustomScrollbar _mCS_1" style="position: sticky; top:110px; height: 781px; max-width:300px;">
						<div id="mCSB_1" class="mCustomScrollBox mCS-dark-thin mCSB_vertical mCSB_inside" style="max-height: none; overflow:auto;" tabindex="0">
							<div id="mCSB_1_container" class="mCSB_container" style="position: relative; top: 0px; left: 0px;" dir="ltr">
								<t t-set="current_url" t-value="website._get_canonical_url(canonical_params=canonical_params).replace('/it_IT/', '/')"/>
								<t t-if="not '/tool/' in current_url and not '/search/' in current_url">
									<div class="px-3 d-block">
										<t if="not categories">
											<t t-set="categories" t-value="request.env['product.public.category'].sudo().search([('parent_id.primary_category','=', True)])" />
										</t>
										
										<t t-if="not category">
											<t t-set="category" t-value="request.env['product.public.category'].sudo().search([('primary_category','=', True)])"/>
										</t>
										<ul class="nav nav-pills flex-column mb-2" id="o_home_collapse_category">
											<t t-foreach="categories" t-as="c">
												<t t-call="netaddiction_special_offers.custom_category_recursive"/>
											</t>
										</ul>
									</div>
									<script>
										function collapseMenu(el, cat_id){
											var status = (el[0].style.display == 'none')?false:true;
											el.forEach(item => {
												item.style.display = (status == false)?'block':'none';
											});

											document.querySelectorAll('.arrow_' + cat_id).forEach(item => {
												if(status == false){
													item.classList.remove('fa-chevron-right');
													item.classList.add('fa-chevron-down');
												}
												else{
													item.classList.add('fa-chevron-right');
													item.classList.remove('fa-chevron-down');
												}
											});
										}
									</script>
								</t>
							</div>
						</div>
					</div>
				</t>
				<section class="container">
					<t t-set="products_ids" t-value="''" />
					<t t-foreach="product_list_id" t-as="prod">
						<t t-set="products_ids" t-value="products_ids + str(prod.id) + ','" />
					</t>
					<t t-set="products_ids" t-value="products_ids[:-1]" />
					<section class="pt8 pb8 o_colored_level offer_product_list" data-snippet="p_slider" data-name="Product Snippet Builder">
						<div class="js_slider_snippet" name="manual-configuration" data-isemipro="true" data-name="manual-configuration" t-attf-data-item_ids="{{products_ids}}" data-style="7" data-ui_option="shopping_cart,wishlist,quick_view,sale_label,ratings" data-slider_type="slider" t-attf-data-limit="{{str(page_size)}}" />
					</section>
				</section>
			</div>
			<t t-call="netaddiction_special_offers.pagination_offer" />
		</t>
	</template>
	<!-- PAGINAZIONE -->
	<template id="pagination_offer">
		<div class="container d-flex custom_pager products_pager form-inline mt-3 mb-3 te_shop_pager">
			<ul class="pagination m-0 ">
				<t t-set="status_filter" t-value="request.params.get('status-filter')"/>
				<t t-set="active_prev" t-value="" />
				<t t-if="current_page == 0">
					<t t-set="active_prev" t-value="'disabled'" />
				</t>
				<li t-attf-class="page-item {{active_prev}}">
					<t t-if="status_filter">
						<t t-set="link_prev" t-value="'/offerte/' + str(offer.id) + '?status-filter=' + status_filter" />
					</t>
					<t t-else="">
						<t t-set="link_prev" t-value="'/offerte/' + str(offer.id)" />
					</t>
					<t t-if="current_page > 1">
						<t t-if="status_filter">
							<t t-set="link_prev" t-value="link_prev + '?page=' + str(current_page) + '&amp;&amp;status-filter=' + status_filter" />
						</t>
						<t t-else="">
							<t t-set="link_prev" t-value="link_prev + '?page=' + str(current_page)" />
						</t>
					</t>
					<a data-oe-model="ir.ui.view" data-oe-id="1332" data-oe-field="arch" data-oe-xpath="/t[1]/ul[1]/li[1]/a[1]" t-attf-href="{{link_prev}}" class="page-link ">
						Prec
					</a>
				</li>
				<t t-set="button_index" t-value="0" />
				
				<t t-foreach="range(current_page, page_number)" t-as="row_index">
					<t t-if="button_index &lt; 5">
						<t t-set="button_index" t-value="(button_index + 1)" />
						<t t-set="active_link" t-value="" />
						<t t-if="current_page == row_index">
							<t t-set="active_link" t-value="'active'" />
						</t>
						<li t-attf-class="page-item {{active_link}}">
							<t t-if="row_index == 0">
								<t t-if="status_filter">
									<a t-attf-href="/offerte/#{str(offer.id)}?status-filter={{status_filter}}" class="page-link" t-esc="(row_index + 1)"></a>
								</t>
								<t t-else="">
									<a t-attf-href="/offerte/#{str(offer.id)}" class="page-link" t-esc="(row_index + 1)"></a>
								</t>
							</t>
							<t t-else="">
								<t t-if="status_filter">
									<a t-attf-href="/offerte/#{str(offer.id)}?page=#{(row_index + 1)}&amp;&amp;status-filter={{status_filter}}" class="page-link" t-esc="(row_index + 1)"></a>
								</t>
								<t t-else="">
									<a t-attf-href="/offerte/#{str(offer.id)}?page=#{(row_index + 1)}" class="page-link" t-esc="(row_index + 1)"></a>
								</t>
							</t>
						</li>
					</t>
				</t>
				<t t-set="active_next" t-value="" />
				<t t-if="(current_page + 1) == page_number">
					<t t-set="active_next" t-value="'disabled'" />
				</t>
				<li t-attf-class="page-item {{active_next}}">
					<t t-set="link_next" t-value="" />
					<t t-if="current_page &lt; page_number">
						<t t-if="status_filter">
							<t t-set="link_next" t-value="'/offerte/' + str(offer.id) + '?page=' + str(current_page + 2) + '&amp;&amp;status-filter=' + status_filter" />
						</t>
						<t t-else="">
							<t t-set="link_next" t-value="'/offerte/' + str(offer.id) + '?page=' + str(current_page + 2)" />
						</t>
					</t>
					<a data-oe-model="ir.ui.view" data-oe-id="1332" data-oe-field="arch" data-oe-xpath="/t[1]/ul[1]/li[2]/a[1]" t-attf-href="{{link_next}}" class="page-link ">
						Succ
					</a>
				</li>
			</ul>
		</div>
	</template>
</odoo>
