<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="loaylty_info" inherit_id="advance_website_all_in_one.web_loaylty_info">
		<xpath expr="//button[@data-target='#redeem_modal']" position="replace">
		</xpath>
		<xpath expr="//div[hasclass('coupon_info')]" position="replace">
			<div class="coupon_info" style="font-size: 16px; color: #077bfe; font-weight: 700;" t-att-data-id="website_sale_order.id">
				<t t-set="partner_loyalty" t-value="website.sudo().get_loyalty_balance(website_sale_order)" />
				<t t-if="partner_loyalty[0] > 0">
					<span>
						+
						<t t-esc="partner_loyalty[0]" />
					</span>
				</t>
				<span>
					Punti Fedeltà:
					<t t-esc="partner_loyalty[1]" />
					.
				</span>
			</div>
		</xpath>
		<xpath expr="//div[hasclass('coupon_info')]" position="replace">
			<div class="coupon_info" t-att-data-id="website_sale_order.id">
				<t t-set="partner_loyalty" t-value="website.sudo().get_loyalty_balance(website_sale_order)" />
				<a role="button" t-att-data-id="website_sale_order.id" data-toggle="modal" data-target="#redeem_modal" class="open-redeem w-100 my-0 btn btn-outline-primary btn-lg d-sm-inline-block te_theme_button px-3 py-1 js_check_product a-submit" href="#">
					Riscatta Punti
				</a>
			</div>
		</xpath>
		<xpath expr="//div[@id='redeem_modal']" position="replace">
			<div id="redeem_modal" class="modal fade" role="dialog">
				<div class="modal-dialog mt-5">
					<!-- Modal content -->
					<div class="modal-content">
						<div class="modal-header justify-content-end">
							<button type="button" class="close" data-dismiss="modal" style="margin-left: 0px;color: red;">
								x
							</button>
						</div>
						<div class="modal-body">
							<div class="my-3" style="color:var(--secondary); text-align: center; font-size: 20px;">
								<p style="margin: 2px;">
									Ciao
									<span class="redeem_name" />
									hai a disposizione:
								</p>
								<big>
									<strong class="redeem_points">
									</strong>
									Punti
								</big>
								<p style="margin: 2px;">
									L'equivalente di
									<strong style="color:var(--primary);" class="redeem_total" />
									<strong style="color:var(--primary);" t-esc="website.currency_id.symbol" />
								</p>
								<span style="display: none;" class="redeem_value">
								</span>
								<span style="display: none;" class="order_id">
								</span>
								<span style="display: none;" class="amount_total">
								</span>
								<span style="display: none;" class="order_redeem_points">
								</span>
							</div>
							<small class="text-left d-block">
								<strong>
									seleziona un numero di punti da riscattare:
								</strong>
							</small>
							<div style="display: grid;">
								<input style="box-shadow:none; outline:none;" id="entered_points" type="number" placeholder="scrivi il numero di punti" class="form-control input-field mb-3" name="code" />
								<a role="button" class="redeem_ok my-0 btn btn-outline-primary btn-lg d-sm-inline-block te_theme_button px-3 py-1 js_check_product a-submit" href="#">
									Riscatta Punti
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</xpath>
	</template>
	<template id="reduction_code_ept" inherit_id="website_sale.reduction_code">
		<xpath expr="//a[hasclass('show_coupon')]" position="replace">
			<a role="button" class="mb-2 show_coupon te_show_cpn w-100 my-0 btn btn-outline-primary btn-lg d-sm-inline-block te_theme_button px-3 py-1 js_check_product a-submit" href="#">
				Ho un codice promo
			</a>
		</xpath>
	</template>
	<template id="voucher_code" inherit_id="website_sale.total" active="True" customize_show="True" name="Voucher Code">
		<xpath expr="//div[hasclass('col-md-offset-7')]" position="replace">
		</xpath>
	</template>
	<template id="custom_shipping_option" inherit_id="website_sale.payment">
		<xpath expr="//div[@id='shipping_and_billing']" position="replace">
			<div class="text-left mb-3 p-3 border" style="box-shadow:0 4px 8px 0 rgb(156 156 156 / 10%), 0 6px 20px 0 rgb(156 156 156 / 10%) !important;">
				<div id="shipping_and_billing">
					<div class="d-block text-right pb-3">
						<a class="adress_edit" href="/shop/checkout">
							<i class="fa fa-pencil" />
							Modifica
						</a>
					</div>
					<t t-set="same_shipping" t-value="bool(order.partner_shipping_id==order.partner_id or only_services)" />
					<div>
						<b>
							<small class="text-primary"><i class="fa fa-map-marker mr-2"/>Indirizzo di Fatturazione
								<t t-if="same_shipping and not only_services">
									&amp; Indirizzo di Spedizione
								</t>
							</small>
						</b>
                        <br/>
						<span t-esc="order.partner_id" t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')" class="address-inline" />
					</div>
					<div t-if="not same_shipping and not only_services" groups="sale.group_delivery_invoice_address">
						<b>
                            <small class="text-primary"><i class="fa fa-map-marker mr-2"/>Indirizzo di Spedizione</small>
						</b>
                        <br/>
						<span t-esc="order.partner_shipping_id" t-options="dict(widget='contact', fields=['address'], no_marker=True, separator=', ')" class="address-inline" />
					</div>
				</div>
			</div>
		</xpath>

	</template>
	<template id="netaddition_order_payment_custom" inherit_id="netaddiction_orders.netaddition_order_payment">
		<xpath expr="//div[hasclass('form-group')]" position="replace">
			<div class="card mt-3">
				<div class="text-left">
					<div class="form-group">
						<h3>
							Note
						</h3>
						<textarea class="form-control" id="note" name="note" rows="3">
							<t t-esc="note or ''" />
						</textarea>
					</div>
				</div>
			</div>
			<div class="card mb-5">
				<div class="custom-control custom-checkbox float-right mt-2">
					<input type="checkbox" id="checkbox_cgv" class="custom-control-input" checked="true"/>
					<label for="checkbox_cgv" class="custom-control-label">
						Accetto i
						<a target="_BLANK" href="https://multiplayer.com/static/pdf/Condizioni-Generali-Multiplayer-Netaddiction.pdf?20210820">
							termini di vendita
						</a>
					</label>
				</div>
			</div> 
		</xpath>
	</template>
	<template id="order_info_custom" inherit_id="website_sale.short_cart_summary">
		<xpath expr="//div[hasclass('js_cart_summary')]" position="replace">
			<div class="js_cart_summary border" style="box-shadow:0 4px 8px 0 rgb(156 156 156 / 10%), 0 6px 20px 0 rgb(156 156 156 / 10%) !important;" t-if="website_sale_order and website_sale_order.website_order_line">
				<div class="card-body">
					<h4 class="d-none d-xl-block">
						Totale ordine
					</h4>
					<hr class="d-none d-xl-block" />
					<div>
						<t t-call="website_sale.total">
							<t t-set="no_rowspan" t-value="1" />
						</t>
						<a id="order_limit_net" role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-secondary float-right d-none d-xl-inline-block">
							<span>
								Vai al Checkout
							</span>
						</a>
					</div>
				</div>
			</div>
		</xpath>
	</template>

    <template id="cart_summary_custom" inherit_id="website_sale.cart_summary" priority="30">
        <xpath expr="//div[hasclass('card')]" position="replace">
            <div class="border" style="box-shadow:0 4px 8px 0 rgb(156 156 156 / 10%), 0 6px 20px 0 rgb(156 156 156 / 10%) !important;">
                <div class="card-body p-xl-0">
                    <div class="toggle_summary d-xl-none">
                        <b>Il tuo ordine: </b> <span id="amount_total_summary" class="monetary_field text-primary" t-field="website_sale_order.amount_total" t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}'/>
                        <span class='fa fa-chevron-down float-right text-primary' role="img" aria-label="Details" title="Details"></span>
                    </div>
                    <div t-if="not website_sale_order or not website_sale_order.website_order_line" class="alert alert-info">
                        <div class="container-fluid"> 
                            <div class="col-md-12 text-center">
                                <h2>IL tuo carrello è vuoto!</h2>
                            </div>
                        </div>
                    </div>
                    <div class="toggle_summary_div d-none d-xl-block mt-4">
                        <table class="table table-striped table-sm" id="cart_products" t-if="website_sale_order and website_sale_order.website_order_line">
                            <thead>
                                <tr>
                                    <th class="border-top-0 td-img"><small class="text-primary">Prodotti</small></th>
                                    <th class="border-top-0"></th>
                                    <th class="border-top-0 td-qty"><small class="text-primary">Quantità</small></th>
                                    <th class="border-top-0 text-center td-price"><small class="text-primary">Prezzo</small></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="website_sale_order.website_order_line" t-as="line">
                                    <td class='' colspan="2" t-if="not line.product_id.product_tmpl_id"></td>
                                    <td class='td-img text-center' t-if="line.product_id.product_tmpl_id">
                                        <span t-field="line.product_id.image_128" t-options="{'widget': 'image', 'qweb_img_responsive': False, 'class': 'rounded o_image_64_max'}" />
                                    </td>
                                    <td class='td-product_name' t-if="line.product_id.product_tmpl_id">
                                        <div>
                                            <small t-field="line.name_short" />
                                        </div>
                                    </td>
                                    <td class='td-qty text-center'>
                                        <div t-esc="line.product_uom_qty" />
                                    </td>
                                    <td class="text-center td-price text-primary">
                                        <span t-field="line.price_reduce_taxexcl" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}" groups="account.group_show_line_subtotals_tax_excluded" />
                                        <span t-field="line.price_reduce_taxinc" style="white-space: nowrap;" t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}" groups="account.group_show_line_subtotals_tax_included" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <t t-call="website_sale.total">
                            <t t-set='redirect' t-value="redirect or '/shop/payment'"></t>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </template>


    <template id="cart_custom" inherit_id="website_sale.cart" priority="30">
        <xpath expr="//div[hasclass('oe_website_sale')]" position="replace">
            <t t-if="not website_sale_order or not website_sale_order.website_order_line">
                <div class="container"> 
                    <div class="col-md-10 text-center mx-auto">
                        <img class="img img-responsive col-xs-12 w-100 w-md-50 mt-3 mb-3" src="/netaddiction_theme_rewrite/static/src/img/empty-cart.png"  alt="Odoo CMS - a big picture" style="max-width:100%"/>
                        <h2>Il tuo carrello è vuoto!</h2>
                        <a role="button" class="button-rounded mt-3 d-inline-block" href="/shop">
                            Torna allo shop
                        </a>
                    </div>
                </div>
            </t>
            <t t-else="">
                <div class="container oe_website_sale py-2">
                    <div class="row">
                        <div class="col-12">
                            <t t-call="website_sale.wizard_checkout">
                                <t t-set="step" t-value="10" />
                            </t>
                        </div>
                        <div class="col-12 col-xl-8 oe_cart">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div t-if="abandoned_proceed or access_token" class="mt8 mb8 alert alert-info" role="alert"> <!-- abandoned cart choices -->
                                        <t t-if="abandoned_proceed">
                                            <p>Your previous cart has already been completed.</p>
                                            <p t-if="website_sale_order">Please proceed your current cart.</p>
                                        </t>
                                        <t t-if="access_token">
                                            <p>This is your current cart.</p>
                                            <p>
                                                <strong><a t-attf-href="/shop/cart/?access_token=#{access_token}&amp;revive=squash">Click here</a></strong> if you want to restore your previous cart. Your current cart will be replaced with your previous cart.</p>
                                            <p>
                                                <strong><a t-attf-href="/shop/cart/?access_token=#{access_token}&amp;revive=merge">Click here</a></strong> if you want to merge your previous cart into current cart.
                                            </p>
                                        </t>
                                    </div>
                                    <t t-call="website_sale.cart_lines" />
                                    <div class="clearfix" />
                                    <a role="button" href="/shop" class="btn btn-secondary mb32 d-none d-xl-inline-block">
                                        <span class="fa fa-chevron-left" />
                                        <span class="">Continua lo shopping</span>
                                    </a>
                                    <a id="order_limit_net" role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-primary float-right d-none d-xl-inline-block">
                                        <span class="">Vai al Checkout</span>
                                        <span class="fa fa-chevron-right" />
                                    </a>
                                    <div class="oe_structure" id="oe_structure_website_sale_cart_1"/>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-xl-4" id="o_cart_summary">
                            <t t-call="website_sale.short_cart_summary"/>
                            <div class="d-xl-none mt-4">
                                <a role="button" href="/shop" class="btn btn-secondary mb32">
                                    <span class="fa fa-chevron-left" />
                                    <span class="d-none d-md-inline">Continua lo shopping</span>
                                </a>
                                <a id="order_limit_net" role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-primary float-right">
                                    <span class="">Vai al Checkout</span>
                                    <span class="fa fa-chevron-right" />
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
    </template>

    <template id="reduction_code_ept" inherit_id="website_sale.reduction_code">
        <xpath expr="//a[hasclass('show_coupon')]" position="replace">
            <a role="button" class="mb-2 show_coupon te_show_cpn w-100 my-0 btn btn-outline-primary btn-lg d-sm-inline-block te_theme_button px-3 py-1 js_check_product a-submit" href="#">
                Ho un codice promo
            </a>
        </xpath>
    </template>
    
    <template id="voucher_code" inherit_id="website_sale.total" active="True" customize_show="True" name="Voucher Code">
		<xpath expr="//div[hasclass('col-md-offset-7')]" position="replace">
			
		</xpath>
	</template>

	<template id="website_wallet_on_payment_page" inherit_id="website_sale.payment">
		<xpath expr="//div[@id='payment_method']/h3" position="after">
			<t t-set="no_footer" t-value="0"/>
			<div t-if="website_sale_order and website_sale_order.website_order_line">
				<t t-set="count" t-value="0"/>
				<t t-foreach ="website_sale_order.website_order_line" t-as="line"> 
				<div t-if ="line.product_id.id != website.wallet_product_id.id">
					<t t-set="count" t-value="1"/>
				</div>
				</t>
				<t t-if="count==1">
					<div class="website-wallet border p-3" style="box-shadow:0 4px 8px 0 rgb(156 156 156 / 10%), 0 6px 20px 0 rgb(156 156 156 / 10%) !important;" t-if="website.wallet_product_id">
						<div class="checkbox">
							<t t-if="not website_sale_order.is_wallet">
								<div id="not_wallet" style="font-size: 16px;margin-right: 5px;">
									<span><i class="fa fa-square-o"></i></span>
									<label class="text-primary" style="font-size: 18px;">Utilizza il credito del Wallet</label>
								</div>
							</t>
							<t t-if="website_sale_order.is_wallet">
								<div id="wallet_checked" style="font-size: 16px;margin-right: 5px;">
									<span><i class="fa fa-check-square-o"></i></span>
									<label class="text-primary" style="font-size: 18px;">Utilizza il credito del Wallet</label>
								</div>
							</t>
						</div>
						<div>
							<b>Disponi di: </b> 
							<t t-set="partner_wallet" t-value="website.sudo().get_wallet_balance(website.currency_id)"/>
							<span class="text-primary" style="font-size: 18px;" t-esc="partner_wallet"/>
							<span class="text-primary" style="font-size: 18px;" t-esc="website.currency_id.symbol"/>
							<br/><br/>
							<small class="border-top pt-2">Selezionando questo metodo pagherai solo in caso ci fosse una differenza tra il tuo wallet e il prezzo dell'ordine.</small>
						</div>
					</div>
				</t>
			</div>
		</xpath>    
		<xpath expr="//div[@id='payment_method']/h3" position="replace">
		
		</xpath>
	</template>

	<template id="website_wallet_on_payment_page_custom" inherit_id="odoo_website_wallet.website_wallet_on_payment_page">
		<xpath expr="//div[@t-if='website_sale_order and website_sale_order.website_order_line']" position="replace">
	
		</xpath>    
	</template>
</odoo>